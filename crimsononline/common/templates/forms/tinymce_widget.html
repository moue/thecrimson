{% load content_filters %}
{{ta}}

<script type="text/javascript">
//$(document).ready(function(){
    tinyMCE.init({
        mode : "exact",
        elements:"{{attrs.id}}",
		plugins: "paste",
        theme : "advanced",
        paste_auto_cleanup_on_paste : true,
        paste_preprocess : function(pl, o) {
            re = new RegExp('<div[^>]+>(.*?)</div>');
            
            content_left = o.content;
            content_return = "";
            m = re.exec(content_left);
            while(m != null){
                content_return = content_return + "<p>" + m[1] + "</p>"
                content_left = content_left.substring(m[0].length,content_left.length);
                m = re.exec(content_left);
            }
            if(content_return)
                o.content = content_return;
            
        }, 
        paste_remove_styles: true,
        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_buttons1 :"undo,redo,separator,bold,italic,underline,separator,link,unlink,separator,cleanup, separator,code,separator,pastetext,pasteword,selectall",
        // styleselect to add advanced styles
        theme_advanced_buttons2 : "",
        theme_advanced_buttons3: "",
        // set these later
        theme_advanced_styles : "Header 1=header1;Header 2=header2;Header 3=header3;Table Row=tableRow1",
        auto_cleanup_word : true,
        valid_elements: "a[href|title|onclick],p[style],span[style],b,i",
        custom_shortcuts: false,
        // don't use p tags
        force_p_newlines : true,
        entities: "amp",
		content_css: "{{css_location}}css/flatpages.css"{% if custom_settings %},{% endif %}
        {{custom_settings}}
    });
//});
</script>

